#!/usr/bin/env bash
set -euo pipefail

source {{ .chezmoi.sourceDir }}/.scripts/ansi.sh
source {{ .chezmoi.sourceDir }}/.scripts/base.sh

if [[ "$OSTYPE" != "linux-gnu"* ]]; then
	ansi --yellow "Not a Linux platform. Skipping."
	exit 0
fi

if [ ! -f "/etc/arch-release" ]; then
	ansi --yellow "Not running arch. Skipping."
fi

ansi --bg-green "Installing OpenSSH
yay -S openssh

ansi --bg-green "Enabling openssh service)
sudo systemctl start --now openssh

# Get the current IP address
ip_address=$(ip -4 addr show | grep -oP '(?<=inet\s)\d+(\.\d+){3}')

# Check if we found an IP address
if [ -z "$ip_address" ]; then
    echo "No IP address found."
else
    echo "Current IP address: $ip_address"
fi
